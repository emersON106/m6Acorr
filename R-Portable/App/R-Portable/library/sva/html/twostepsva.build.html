<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: A function for estimating surrogate variables with the two...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for twostepsva.build {sva}"><tr><td>twostepsva.build {sva}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>A function for estimating surrogate variables with the two step approach of Leek and Storey 2007</h2>

<h3>Description</h3>

<p>This function is the implementation of the two step approach for estimating surrogate
variables proposed by Leek and Storey 2007 PLoS Genetics. This function is primarily
included for backwards compatibility. Newer versions of the sva algorithm are available
through <code><a href="sva.html">sva</a></code>, <code><a href="svaseq.html">svaseq</a></code>, with low level functionality available
through <code><a href="irwsva.build.html">irwsva.build</a></code> and <code><a href="ssva.html">ssva</a></code>.
</p>


<h3>Usage</h3>

<pre>
twostepsva.build(dat, mod, n.sv)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>dat</code></td>
<td>
<p>The transformed data matrix with the variables in rows and samples in columns</p>
</td></tr>
<tr valign="top"><td><code>mod</code></td>
<td>
<p>The model matrix being used to fit the data</p>
</td></tr>
<tr valign="top"><td><code>n.sv</code></td>
<td>
<p>The number of surogate variables to estimate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sv The estimated surrogate variables, one in each column
</p>
<p>pprob.gam: A vector of the posterior probabilities each gene is affected by heterogeneity
</p>
<p>pprob.b A vector of the posterior probabilities each gene is affected by mod (this is always null for the two-step approach)
</p>
<p>n.sv The number of significant surrogate variables
</p>


<h3>Examples</h3>

<pre>
library(bladderbatch)
library(limma)
data(bladderdata)
dat &lt;- bladderEset

pheno = pData(dat)
edata = exprs(dat)
mod = model.matrix(~as.factor(cancer), data=pheno)

n.sv = num.sv(edata,mod,method="leek")
svatwostep &lt;- twostepsva.build(edata,mod,n.sv)

</pre>

<hr /><div style="text-align: center;">[Package <em>sva</em> version 3.32.1 <a href="00Index.html">Index</a>]</div>
</body></html>
